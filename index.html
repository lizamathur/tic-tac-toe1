<!DOCTYPE HTML>
<html>
    <head>
        <link rel="icon" type="image" href="t1.jpg"/>
        <title>Tic Tac Toe</title>
        <link rel="stylesheet" type="text/css" href="css3.css"/>
        <script type="text/javascript">

        var painted;
        var content;
        var winningCombinations;
        var count = 0;
        var turn="user";
        var theCanvas;
        var c;
        var rep=0;
        var cxt;
        var squaresFilled = 0;
        var i=0,win=0;
        window.onload=function(){
            
            painted = new Array();
            content = new Array();
            winningCombinations = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

            for(var l = 0; l <= 8; l++){
            painted[l] = false;
            content[l]='';
            }
        }

        function canvasClicked(canvasNumber){

            theCanvas = "canvas"+canvasNumber;
            c = document.getElementById(theCanvas);
            cxt = c.getContext("2d");

            if(turn=="user" && count%2==0){
                //console.log("Players Turn");
                if(painted[canvasNumber-1]==false){
                    content[canvasNumber-1] = 'X';
                        painted[canvasNumber-1]=true;
                        cxt.beginPath();
                        cxt.moveTo(10,10);
                        cxt.lineTo(90,90);
                        cxt.moveTo(90,10);
                        cxt.lineTo(10,90);
                        cxt.lineWidth=5;
                        cxt.strokeStyle="white";
                        cxt.stroke();
                        cxt.closePath();
                        squaresFilled++;
                        count=count+1;
                        check=1;
                        i=0;
                        rep=0;
                        checkForWinners(content[canvasNumber-1]);
                        if(win==0)
                        playcomputer();
                }
                else{
                    alert("The space is already occupied");
                    turn="user";
                }
            }
            else{
                alert("Wait for Computer!");
            }
            
        };

        var playcomputer=function(){
            turn="computer";
            for(var a=0;a<winningCombinations.length;a++){
                if((content[winningCombinations[a][0]]=='O')&&(content[winningCombinations[a][1]]=='O')&&(content[winningCombinations[a][2]]=='')&&check==1)
                    comp(winningCombinations[a][2]+1);
                else
                    check+=1;
                if((content[winningCombinations[a][0]]=='O')&&(content[winningCombinations[a][2]]=='O')&&(content[winningCombinations[a][1]]=='')&&check==2)
                    comp(winningCombinations[a][1]+1);
                else
                    check+=1;
                if((content[winningCombinations[a][1]]=='O')&&(content[winningCombinations[a][2]]=='O')&&(content[winningCombinations[a][0]]=='')&&check==3)
                    comp(winningCombinations[a][0]+1);
                else
                    check=1;
            }
            for(var a=0;a<winningCombinations.length;a++){
                if((content[winningCombinations[a][0]]=='X')&&(content[winningCombinations[a][1]]=='X')&&(content[winningCombinations[a][2]]=='')&&check==1)
                    comp(winningCombinations[a][2]+1);
                else
                    check+=1;
                if((content[winningCombinations[a][0]]=='X')&&(content[winningCombinations[a][2]]=='X')&&(content[winningCombinations[a][1]]=='')&&check==2)
                    comp(winningCombinations[a][1]+1);
                else
                    check+=1;
                if((content[winningCombinations[a][1]]=='X')&&(content[winningCombinations[a][2]]=='X')&&(content[winningCombinations[a][0]]=='')&&check==3)
                    comp(winningCombinations[a][0]+1);
                else{
                    check=1;
                    rep=1;
                }
            }  
            if(a==winningCombinations.length&&rep==1)         
            comp(Math.floor(Math.random()*9)+1);
        };

        var comp=function(num){

            theCanvas = "canvas"+num;
            c = document.getElementById(theCanvas);
            cxt = c.getContext("2d");

            if(turn=="computer" && count%2!=0)
            {
                console.log("Computers turn");
                if(painted[num-1]==false){
                    content[num-1] = 'O';
                    painted[num-1]=true;
                    cxt.beginPath();
                    cxt.arc(50,50,40,0,Math.PI*2,true);
                    cxt.lineWidth=5;
                    cxt.strokeStyle="white";
                    cxt.stroke();
                    cxt.closePath();
                    squaresFilled++;
                    count=count+1;
                    check=1;
                    i=0;
                    rep=0;
                    turn="user";
                    checkForWinners(content[num-1]);
                }
                else{
                        playcomputer();
                        if(check==3)
                            check=1;
                        check+=1;
                }
            }
            
        };

        function checkForWinners(symbol){
            
            if(squaresFilled==9){
                alert("Game Over");
                win=1;
                location.reload();
            }
            for(var a = 0; a < winningCombinations.length; a++){
                if(content[winningCombinations[a][0]]==symbol&&content[winningCombinations[a][1]]==symbol&&content[winningCombinations[a][2]]==symbol){
                    alert(symbol+" WON!");
                    win=1;
                    location.reload();
                    break;
                }
            }

        }
        </script>
    </head>
    <body>
        <h1> <span style="color:blue">Tic</span>-<span style="color:white">Tac</span>-<span style="color:red">Toe</span> </h1>
        <div id ="box"  width="300" height="300" align="center">
            <canvas id = "canvas1"  width="100" height="100" style="border:10px solid blue" onclick="canvasClicked(1)"></canvas>
            <canvas id = "canvas2"  width="100" height="100" style="border:10px solid red" onclick="canvasClicked(2)"></canvas>
            <canvas id = "canvas3"  width="100" height="100" style="border:10px solid blue" onclick="canvasClicked(3)"></canvas><br/>
            <canvas id = "canvas4"  width="100" height="100" style="border:10px solid red" onclick="canvasClicked(4)"></canvas>
            <canvas id = "canvas5"  width="100" height="100" style="border:10px solid yellow" onclick="canvasClicked(5)"></canvas>
            <canvas id = "canvas6"  width="100" height="100" style="border:10px solid red" onclick="canvasClicked(6)"></canvas><br/>
            <canvas id = "canvas7"  width="100" height="100" style="border:10px solid blue" onclick="canvasClicked(7)"></canvas>
            <canvas id = "canvas8"  width="100" height="100" style="border:10px solid red" onclick="canvasClicked(8)"></canvas>
            <canvas id = "canvas9"  width="100" height="100" style="border:10px solid blue" onclick="canvasClicked(9)"></canvas>
        </div>
    </body>
</html>